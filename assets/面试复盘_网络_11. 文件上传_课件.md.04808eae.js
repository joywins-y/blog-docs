import{_ as s,o as a,c as n,V as l}from"./chunks/framework.bd00fe0c.js";const b=JSON.parse('{"title":"文件上传的消息格式","description":"","frontmatter":{},"headers":[],"relativePath":"面试复盘/网络/11. 文件上传/课件.md","filePath":"面试复盘/网络/11. 文件上传/课件.md","lastUpdated":1712573589000}'),p={name:"面试复盘/网络/11. 文件上传/课件.md"},o=l(`<h1 id="文件上传的消息格式" tabindex="-1">文件上传的消息格式 <a class="header-anchor" href="#文件上传的消息格式" aria-label="Permalink to &quot;文件上传的消息格式&quot;">​</a></h1><p>文件上传的本质仍然是一个数据提交，无非就是数据量大一些而已</p><p>在实践中，人们逐渐的形成了一种共识，我们自行规定，文件上传默认使用下面的请求格式</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">POST 上传地址 HTTP/1.1</span></span>
<span class="line"><span style="color:#babed8;">其他请求头</span></span>
<span class="line"><span style="color:#babed8;">Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW</span></span>
<span class="line"><span style="color:#babed8;"></span></span>
<span class="line"><span style="color:#babed8;">----WebKitFormBoundary7MA4YWxkTrZu0gW</span></span>
<span class="line"><span style="color:#babed8;">Content-Disposition: form-data; name=&quot;avatar&quot;; filename=&quot;小仙女.jpg&quot;</span></span>
<span class="line"><span style="color:#babed8;">Content-Type: image/jpeg</span></span>
<span class="line"><span style="color:#babed8;"></span></span>
<span class="line"><span style="color:#babed8;">(文件二进制数据)</span></span>
<span class="line"><span style="color:#babed8;">----WebKitFormBoundary7MA4YWxkTrZu0gW</span></span>
<span class="line"><span style="color:#babed8;">Content-Disposition: form-data; name=&quot;username&quot;</span></span>
<span class="line"><span style="color:#babed8;"></span></span>
<span class="line"><span style="color:#babed8;">admin</span></span>
<span class="line"><span style="color:#babed8;">----WebKitFormBoundary7MA4YWxkTrZu0gW</span></span>
<span class="line"><span style="color:#babed8;">Content-Disposition: form-data; name=&quot;password&quot;</span></span>
<span class="line"><span style="color:#babed8;"></span></span>
<span class="line"><span style="color:#babed8;">123123</span></span>
<span class="line"><span style="color:#babed8;">----WebKitFormBoundary7MA4YWxkTrZu0gW</span></span></code></pre></div><ul><li>除非接口文档特别说明，文件上传一般使用POST请求</li><li>接口文档中会规定上传地址，一般一个站点会有一个统一的上传地址</li><li>除非接口文档特别说明，<code>content-type: multipart/form-data</code>，浏览器会自动分配一个定界符<code>boundary</code></li><li>请求体的格式是一个被定界符<code>boundary</code>分割的消息，每个分割区域本质就是一个键值对</li><li>除了键值对外，<code>multipart/form-data</code>允许添加其他额外信息，比如文件数据区域，一般会把文件在本地的名称和文件MIME类型告诉服务器</li></ul><h1 id="文件上传的实现" tabindex="-1">文件上传的实现 <a class="header-anchor" href="#文件上传的实现" aria-label="Permalink to &quot;文件上传的实现&quot;">​</a></h1><p>在现代的网页交互中，带表单的文件上传通常使用下面的方式实现</p><p><img src="http://mdrs.yuanjin.tech/img/20210917132919.png" alt="文件上传逻辑"></p><blockquote><p>后端开发服务器：<a href="http://localhost:8000" target="_blank" rel="noreferrer">http://localhost:8000</a></p></blockquote><h1 id="接口示例" tabindex="-1">接口示例 <a class="header-anchor" href="#接口示例" aria-label="Permalink to &quot;接口示例&quot;">​</a></h1><h2 id="统一上传接口" tabindex="-1">统一上传接口 <a class="header-anchor" href="#统一上传接口" aria-label="Permalink to &quot;统一上传接口&quot;">​</a></h2><p><strong>请求路径</strong>：/api/upload</p><p><strong>请求方法</strong>：POST</p><p><strong>字段名</strong>：file</p><p><strong>尺寸限制</strong>：1M</p><p><strong>支持的文件后缀</strong>：.jpg, .jpeg, .gif, .png, .bmp, .webp</p><p><strong>上传成功的响应</strong>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#FFCB6B;">code</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://localhost:8000/upload/a32d18.jpg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 访问路径</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p><strong>可能发生的失败响应</strong>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#FFCB6B;">code</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">403</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#FFCB6B;">msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">文件超过了限制</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#FFCB6B;">data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#FFCB6B;">code</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">403</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#FFCB6B;">msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">无效的文件类型</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#FFCB6B;">data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="用户注册接口" tabindex="-1">用户注册接口 <a class="header-anchor" href="#用户注册接口" aria-label="Permalink to &quot;用户注册接口&quot;">​</a></h2><p><strong>请求路径</strong>：/api/user/reg</p><p><strong>请求方法</strong>：POST</p><p><strong>支持消息类型</strong>：</p><ol><li>x-www-form-urlencoded</li><li>json</li></ol><p><strong>字段</strong>：</p><table><thead><tr><th>字段名</th><th>含义</th><th>是否必须</th></tr></thead><tbody><tr><td>username</td><td>账号</td><td>是</td></tr><tr><td>password</td><td>密码</td><td>是</td></tr><tr><td>avatar</td><td>头像</td><td>是</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><p><strong>注册成功的响应</strong>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#FFCB6B;">code</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">username</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">monica</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">avatar</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://localhost:8000/upload/a234wq1.jpg</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div>`,30),t=[o];function e(r,c,F,i,y,d){return a(),n("div",null,t)}const u=s(p,[["render",e]]);export{b as __pageData,u as default};
